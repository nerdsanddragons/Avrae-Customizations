{{g,r,c,R,t,T,L=load_json(get_gvar('9274bf9a-f3d2-407e-9723-0a8901d04003')),vroll('1d100'),combat(),vroll('1d20'),'&1&' in 'tidesroll',"Tides of Chaos",int("&1&") if "&1&".isdigit() else 0}}{{g=g[ceil(L/2 or r.total/2)-1]}}{{'multiline\n!embed' if not L and g.type=='cast' and (R.total==1 or t) else 'embed'}} {{s=[x for x in range(1,10) if get_slots(x)<get_slots_max(x)]}} {{"-desc '*No Wild Surge*'" if not L and R.total>1 and not t else f" -f '{f'Looking up roll: {L}' if L else r}{f' - {T}' if t and cc_exists(T) else ''} | {g.desc}'"}}{{Roll=vroll(g.roll) if g.type=='roll' or g.type=='health' else 0 }}{{mod_hp(Roll.total) if not L and g.type=='health' and (R.total==1 or t) else ''}}{{set_slots(s[0],get_slots(s[0])+1) if not L and g.type=='slots' and s and (R.total==1 or t) else ''}}{{set_cc('Sorcery Points', get_cc_max('Sorcery Points')) if not L and g.type=='cc' and (R.total==1 or t) else ''}}{{c.me.add_effect(g.effect[0],g.effect[2],g.effect[1]) if not L and g.type=='effect' and c and c.me and (R.total==1 or t) else ''}}{{'' if R.total>1 and not t else (f" -f 'Roll|{Roll}'" if g.type=='Roll' else f" -f 'Health gained|{Roll}\n{hp_str()}'" if g.type=='health' else f" -f 'Regain Slot|{slots_str(s[0]) if s else '*None*'}'" if g.type=='slots' else f" -f 'Sorcerer Points|{cc_str('Sorcery Points')}'" if g.type=='cc' else f" -f 'Gained Effect|Name: {g.effect[0]}\nDuration: {g.effect[1]} rounds'" if g.type =='effect' else '')}} -title "Wild Magic Surge {{'| '+str(R) if not (t or L) else ''}}" {{not cc_exists(T) or mod_cc(T,1) or f" -f '{T}|Recharged'" if not L and t else ''}} -color <color> -thumb <image>  -footer "!wmsurge - Roll for chance | !wmsurge [tide|roll] - Force a roll | !wmsurge [#] - Lookup a roll" 
{{'' if not L and R.total>1 and not t else (f'''!{f"""i reactcast "{name}" """ if c and c.me else "cast"} "{g.cast[0]}" -i -l {g.cast[1]} {"-t "+name if g.cast[2] else ""}''' if g.type=='cast' else '')}}